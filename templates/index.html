<!doctype html>
<html>
<head>
  <title>Poker Hand Odds</title>
  <script src="{{ url_for('static', filename='script.js') }}"></script>
  <link type="text/css" rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='deck-of-cards/cards.css') }}">
</head>
<body>
  <script src="{{ url_for('static', filename='deck-of-cards/deck.js') }}"></script>
  <h1>Poker Hand Odds Learning Tool</h1>
  <header>
    <h1>Poker Hand Odds</h1>
  </header>
  
  <div class="row">
    <div class="col-1"></div>
    <div class="col-10">
      <div class="container">
        <div class="progress-wrap">
         <ol class="progress-wizard">
           <li class="progress-point current todo stepone">Pre Flop</li>
           <li class="progress-point todo steptwo">Flop</li>
           <li class="progress-point todo stepthree">Turn</li>
           <li class="progress-point todo stepfour">River</li>
         </ol>
         </div>
       </div>
    </div>
    <div class="col-1"></div>
  </div>

  <div class="row">
    <div class="col-3">
      <h3>Your Hand</h3>  
    </div>
    <div class="col-9">
      <h3>Board</h3>  
    </div>
  </div>
  
  <div class="row">
    <div class="col-3">
      <img class="card hand-card" src="{{ url_for('static', filename='deck-of-cards/faces/back.png') }}">
      <img class="card hand-card" src="{{ url_for('static', filename='deck-of-cards/faces/back.png') }}">
    </div>
    <div class="col-9">
      <img class="card board-card" src="{{ url_for('static', filename='deck-of-cards/faces/back.png') }}">
      <img class="card board-card" src="{{ url_for('static', filename='deck-of-cards/faces/back.png') }}">
      <img class="card board-card" src="{{ url_for('static', filename='deck-of-cards/faces/back.png') }}">
      <img class="card board-card" src="{{ url_for('static', filename='deck-of-cards/faces/back.png') }}">
      <img class="card board-card" src="{{ url_for('static', filename='deck-of-cards/faces/back.png') }}">
    </div>
  </div>
  <form action="/calculate" method="post" id="calculate_form">
    <div class="row">
      <div class="col-3">

          <input type="text" maxlength="3" class="card-input hidden" name="hand1">
          <input type="text" maxlength="3" class="card-input hidden" name="hand2">
          
          <input type="submit" value="Calculate">

      </div>
      <div class="col-9">
        <input type="text" maxlength="3" class="card-input hidden" name="board1">
        <input type="text" maxlength="3" class="card-input hidden" name="board2">
        <input type="text" maxlength="3" class="card-input hidden" name="board3">
        <input type="text" maxlength="3" class="card-input hidden" name="board4">
        <input type="text" maxlength="3" class="card-input hidden" name="board5">
      </div>
    </div>
  </form> 


  <div id="app"></div>
  <script>
      const form = document.getElementById("calculate_form");
      form.addEventListener("submit", handleFormSubmit);

      async function postFormDataAsJson({ url, formData }) {
        const fetchOptions = {
          method: "POST",
          body: formData
        };
        const response = await fetch(url, fetchOptions);
        if (!response.ok) {
          const errorMessage = await response.text();
          throw new Error(errorMessage);
        }
        return response.json();
      }

      async function handleFormSubmit(event) {
        event.preventDefault();
        const form = event.currentTarget;
        const url = form.action;

        try {
          const formData = new FormData(form);
          var hero_hand = formData.get('hand1') + formData.get('hand2')

          var board_state = formData.get('board1') + formData.get('board2') + formData.get('board3') + formData.get('board4') + formData.get('board5')


          formData.append('action', 'RFI');
          formData.append('villan_position', 'BU');
          formData.append('hero_position', 'CO');
          formData.append('hero_hand', hero_hand);


          const responseData = await postFormDataAsJson({ url, formData });
          var contentDiv = document.getElementById("app");
          contentDiv.innerHTML = responseData.win;
        } catch (error) {
          console.error(error);
        }
      }
  </script>

</body>
</html>
